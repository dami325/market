## E 커머스 MILESTONE

### 프로젝트 기간
- 2024-12-29 ~ 2025-01-16

### 총 소요 기간
  총 16 MD (Man-days)

### 주요 마일스톤
1. **설계 및 문서 작성**
    - 날짜: **2024-12-31**
    - 주요 작업: UML 작성, ERD 설계

2. **API 명세 및 Mock API 작성**
    - 날짜: **2025-01-03**
    - 주요 작업: 잔액 충전/조회 API, 상품 조회, 선착순 쿠폰 기능, 주문/결제, 상위 상품 조회

3. **테스트 환경 구성**
    - 날짜: **2025-01-04**
    - 주요 작업: 테스트 환경 구축 및 설정

4. **도메인 개발**
    - 날짜: **2025-01-09**
    - 주요 작업: 회원, 쿠폰, 상품, 결제, 주문 도메인 개발

5. **인프라 개발**
    - 날짜: **2025-01-16**
    - 주요 작업: Redis, Kafka 설정 및 개발

6. **프로젝트 배포**
    - 날짜: **2025-01-17**
    - 주요 작업: PR 문서 작성 및 최종 점검

```mermaid
gantt
   title E 커머스 서비스 프로젝트
   dateFormat  YYYY-MM-DD

   section 설계 및 문서 작성
      UML 작성                 :a1, 2024-12-29, 1d
      ERD 설계                 :a2, 2024-12-30, 1d
      설계 및 문서 작성 완료                 :milestone, 2024-12-31, 0d

   section API 명세 및 Mock API 작성
      잔액 충전/조회 API        :a3, 2024-12-31, 1d
      상품 조회                :a4, 2025-01-01, 1d
      선착순 쿠폰 기능          :a5, 2025-01-01, 1d
      주문/결제                :a6, 2025-01-02, 1d
      상위 상품 조회           :a7, 2025-01-02, 1d
      API 명세 및 Mock API 작성 완료             :milestone, 2025-01-03, 0d

   section 테스트 환경 구성
      테스트 환경 구성          :a8, 2025-01-03, 1d
      테스트 환경 구성 완료     :milestone, 2025-01-04, 0d

   section 도메인 개발
      회원 도메인 개발          :b1, 2025-01-04, 1d
      쿠폰 도메인 개발          :b2, 2025-01-05, 1d
      상품 도메인 개발          :b3, 2025-01-06, 1d
      결제 도메인 개발          :b4, 2025-01-07, 1d
      주문 도메인 개발          :b5, 2025-01-08, 1d
      도메인 개발 완료          :milestone, 2025-01-09, 0d

   section 인프라 개발
      인프라 개발 (레디스, 카프카) :c1, 2025-01-09, 7d
      인프라 개발 완료           :milestone, 2025-01-16, 0d

   section 기타
      PR 문서 작성              :d1, 2025-01-16, 1d
      프로젝트 완료             :milestone, 2025-01-17, 0d
```

# 요구사항 기반 전체 시퀀스 다이어그램
- E 커머스 서비스의 주요 요구사항을 기반으로, 주요 도메인 간의 상호작용을 표현한 것입니다. 
- 서비스의 전반적인 흐름과 각 기능 간의 관계를 시각적으로 이해할 수 있도록 작성되었습니다.
- 다이어그램에 포함된 각 요청 및 응답은 REST API 를 기반으로 합니다.

### 주요 기능 포함 내용
- 사용자 잔액 충전 및 조회
- 상품 정보 조회
- 선착순 쿠폰 발급 및 조회
- 주문 및 결제 처리
- 데이터 플랫폼으로의 주문 정보 전송

```mermaid
sequenceDiagram
actor 사용자 as 사용자
participant 쿠폰 as 쿠폰
participant 상품 as 상품
participant 주문 as 주문
participant 결제 as 결제
participant 지갑 as 지갑

사용자->>+지갑: 잔액 조회 요청 (사용자 ID)
지갑->>지갑: 사용자 잔액 조회
지갑-->>사용자: 잔액 정보 반환

사용자->>+지갑: 잔액 충전 요청 (사용자 ID, 충전 금액)
지갑->>지갑: 잔액 업데이트 (+충전 금액)
지갑->>지갑: 충전 내역 저장
지갑-->>사용자: 충전 완료 메시지

사용자->>+상품: 일반 상품 조회 요청
상품->>상품: 상품 정보 조회 (ID, 이름, 가격, 잔여수량)
상품-->>사용자: 상품 정보 반환

사용자->>+상품: 상위 상품 조회 요청
상품->>상품: 최근 3일간 주문 데이터 조회
상품->>상품: 상위 5개 상품 선정
상품-->>사용자: 상위 상품 정보 반환 (상품ID, 이름, 판매량)

사용자->>+쿠폰: 선착순 쿠폰 정보 조회 (사용자 ID)
쿠폰-->>사용자: 쿠폰 정보 반환 (쿠폰ID, 남은 수량 등)

사용자->>+쿠폰: 쿠폰 신청 (사용자 ID)
쿠폰->>쿠폰: 쿠폰 상태 검증 (사용 가능 여부 확인)
쿠폰->>쿠폰: 발행량 +1
쿠폰->>쿠폰: 쿠폰 발급 내역 저장
쿠폰-->>사용자: 200 OK (쿠폰 발행 완료 메시지)

사용자->>+주문: 주문 및 결제 요청 (사용자 ID, 상품ID, 수량, 쿠폰ID 등)
주문->>주문: 주문 정보 저장
주문-->>결제: 주문 정보 전달
alt 결제 성공
    결제->>+지갑: 사용자 잔액 조회 (사용자 ID)
    지갑-->>결제: 사용자 잔액 정보 반환
    결제->>+쿠폰: 쿠폰 유효성 검증 및 할인 금액 확인 (사용자 ID, 쿠폰ID)
    쿠폰-->>결제: 할인 금액 반환
    결제->>+주문: 주문 정보 검증
    결제->>+지갑: 사용자 잔액 차감 (사용자 ID, 차감 금액)
    결제->>+상품: 상품 잔여 수량 차감 (상품ID, 수량)
    결제->>결제: 결제 정보 저장
    결제->>주문: 결제 상태 업데이트 (결제 완료)
    결제->>결제: 주문 정보 전송
    결제-->>사용자: 결제 성공 메시지
else 결제 실패
    결제->>주문: 결제 상태 업데이트 (결제 실패)
    결제-->>사용자: 결제 실패 메시지
end
```
